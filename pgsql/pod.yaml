apiVersion: v1
kind: Pod
metadata:
  name: postgres
  labels:
    app: postgres
  namespace: kafka
spec:
  containers:
    - name: postgres
      image: postgres:13
      imagePullPolicy: "IfNotPresent"
      env:
        - name: POSTGRES_USER
          valueFrom:
            secretKeyRef:
              name: postgres-secret
              key: postgres-root-username
        - name: POSTGRES_PASSWORD
          valueFrom:
            secretKeyRef:
              name: postgres-secret
              key: postgres-root-password
        - name: POSTGRES_DB
          valueFrom:
            configMapKeyRef:
              name: postgres-configmap
              key: postgres-dbname
      volumeMounts:
      - name: postgres-volume
        mountPath: /data
      ports:
      - containerPort: 5432
  volumes:
  - name: postgres-volume
    persistentVolumeClaim:
      claimName: postgres-pv-claim  